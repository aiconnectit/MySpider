C51 COMPILER V9.54   KEY                                                                   03/07/2020 11:56:05 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\Objects\Key.obj
COMPILER INVOKED BY: D:\MDK5\C51\BIN\C51.EXE Key.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\Key.lst)
                    - TABS(2) OBJECT(.\Objects\Key.obj)

line level    source

   1          #include "Key.h"
   2          
   3          
   4          code u8 RowScanVal[4] = {0xfe, 0xfd, 0xfb, 0xf7}; //é”®ç›˜é€è¡Œæ‰«æå€¼
   5          /**********************************************************
   6          å‡½æ•°åç§°ï¼šGetKeyVal_Button
   7          å‡½æ•°åŠŸèƒ½ï¼šè¯»å–ç‹¬ç«‹æŒ‰é”®ï¼Œä»…é‡‡é›†æŒ‰ä¸‹åŠ¨ä½œï¼Œè¿”å›æŒ‰é”®å­—é¢å€¼
   8          å…¥å£å‚æ•°ï¼šæ— 
   9          å‡ºå£å‚æ•°ï¼šKeyValæŒ‰ä¸‹é”®çš„å­—é¢å€¼
  10          å¤‡æ³¨ï¼š
  11          **********************************************************/
  12          u8 GetKeyVal_Button(void) //ç‹¬ç«‹å¼æŒ‰é”®è¯»å–é”®å€¼å‡½æ•°
  13          {
  14   1        static u8 k4_old = 0x0f;    //ä¸Šæ¬¡æŒ‰é”®ç”µå¹³å€¼
  15   1        static KeyState_T S6State = NoKey;  //S6å¾®çŠ¶æ€
*** ERROR C141 IN LINE 15 OF Key.c: syntax error near 'S6State'
*** ERROR C202 IN LINE 15 OF Key.c: 'NoKey': undefined identifier
  16   1        static u8 S6_LOW_cnt = 0;   //S6ä½ç”µå¹³è®¡æ—¶å™¨
  17   1        uChar8 k4_now, tmp, KeyVal;
*** ERROR C202 IN LINE 17 OF Key.c: 'uChar8': undefined identifier
*** ERROR C141 IN LINE 17 OF Key.c: syntax error near 'k4_now'
  18   1        
  19   1        P3 = 0xff;
  20   1        k4_now = P3 & 0x0f;   //è¯»å–æŒ‰é”®å€¼ï¼ˆä½å››ä½ï¼‰
*** ERROR C202 IN LINE 20 OF Key.c: 'k4_now': undefined identifier
  21   1        
  22   1        tmp = k4_old ^ k4_now;  //å¼‚æˆ–æ±‚å˜åŒ–ï¼Œæœ‰å˜åŒ–çš„ä½ä¸º1
*** ERROR C202 IN LINE 22 OF Key.c: 'tmp': undefined identifier
  23   1        if(tmp)         //è‹¥æŒ‰é”®æœ‰æ–°åŠ¨ä½œï¼Œä¸æ”¯æŒç»„åˆé”®ï¼Œä»…å¯¹æŒ‰é”®æŒ‰ä¸‹æœ‰å“åº”
*** ERROR C202 IN LINE 23 OF Key.c: 'tmp': undefined identifier
  24   1        {
  25   2          S6_LOW_cnt = 0;   
  26   2          switch(tmp)
*** ERROR C202 IN LINE 26 OF Key.c: 'tmp': undefined identifier
  27   2          {
  28   3            case 0x01:  if(S7)
  29   3                    KeyVal = NOKEY;   //S7æ¾å¼€
*** ERROR C202 IN LINE 29 OF Key.c: 'KeyVal': undefined identifier
  30   3                  else
  31   3                    KeyVal = S7DOWN;  //S7æŒ‰ä¸‹
*** ERROR C202 IN LINE 31 OF Key.c: 'KeyVal': undefined identifier
  32   3                  break;
  33   3            case 0x02:  if(S6)
  34   3                    KeyVal = NOKEY;   //S6æ¾å¼€
*** ERROR C202 IN LINE 34 OF Key.c: 'KeyVal': undefined identifier
  35   3                  else
  36   3                  {
  37   4                    KeyVal = S6DOWN;  //S6æŒ‰ä¸‹
*** ERROR C202 IN LINE 37 OF Key.c: 'KeyVal': undefined identifier
  38   4                    S6State = KeyDown;
*** ERROR C202 IN LINE 38 OF Key.c: 'KeyDown': undefined identifier
  39   4                  }
  40   3                  break;
  41   3            case 0x04:  if(S5)
C51 COMPILER V9.54   KEY                                                                   03/07/2020 11:56:05 PAGE 2   

  42   3                    KeyVal = NOKEY;   //S5æ¾å¼€
*** ERROR C202 IN LINE 42 OF Key.c: 'KeyVal': undefined identifier
  43   3                  else
  44   3                    KeyVal = S5DOWN;  //S5æŒ‰ä¸‹
*** ERROR C202 IN LINE 44 OF Key.c: 'KeyVal': undefined identifier
  45   3                  break;
  46   3            case 0x08:  if(S4)
  47   3                    KeyVal = NOKEY;   //S4æ¾å¼€
*** ERROR C202 IN LINE 47 OF Key.c: 'KeyVal': undefined identifier
  48   3                  else
  49   3                    KeyVal = S4DOWN;  //S4æŒ‰ä¸‹
*** ERROR C202 IN LINE 49 OF Key.c: 'KeyVal': undefined identifier
  50   3                  break;
  51   3            default:  KeyVal = NOKEY; 
*** ERROR C202 IN LINE 51 OF Key.c: 'KeyVal': undefined identifier
  52   3                  break;
  53   3          }
  54   2        }
  55   1        else    //æ— å˜åŒ–ï¼Œéœ€è¦è€ƒè™‘S6é•¿æŒ‰
  56   1        {
  57   2          if(!S6)
  58   2          {
  59   3            if(S6State == KeyDown)
*** ERROR C202 IN LINE 59 OF Key.c: 'KeyDown': undefined identifier
  60   3            {
  61   4              if(++ S6_LOW_cnt == 80) //0.8ç§’
  62   4              {
  63   5                S6State = KeyHold;
*** ERROR C202 IN LINE 63 OF Key.c: 'KeyHold': undefined identifier
  64   5                KeyVal = S6HOLD;
*** ERROR C202 IN LINE 64 OF Key.c: 'KeyVal': undefined identifier
  65   5              }
  66   4              else
  67   4                KeyVal = NOKEY;   //ä¸åˆ°0.8ç§’
*** ERROR C202 IN LINE 67 OF Key.c: 'KeyVal': undefined identifier
  68   4            }
  69   3            else if(S6State == KeyHold) //è¶…è¿‡0.8ç§’
*** ERROR C202 IN LINE 69 OF Key.c: 'KeyHold': undefined identifier
  70   3              KeyVal = S6HOLD;
*** ERROR C202 IN LINE 70 OF Key.c: 'KeyVal': undefined identifier
  71   3          }
  72   2          KeyVal = NOKEY;
*** ERROR C202 IN LINE 72 OF Key.c: 'KeyVal': undefined identifier
  73   2        } 
  74   1        k4_old = k4_now;  //å¤‡ä»½æœ¬æ¬¡æŒ‰é”®ç”µå¹³å€¼
*** ERROR C202 IN LINE 74 OF Key.c: 'k4_now': undefined identifier
  75   1        return KeyVal;
*** ERROR C202 IN LINE 75 OF Key.c: 'KeyVal': undefined identifier
  76   1      }
  77          
  78          /**********************************************************
  79          å‡½æ•°åç§°ï¼šGetKeyVal_Keyboard
  80          å‡½æ•°åŠŸèƒ½ï¼šè¯»å–å½“å‰è¡Œçš„æŒ‰é”®ç”µå¹³ï¼Œå¯¹æ¯”ä¸Šæ¬¡è¯¥è¡Œçš„ç”µå¹³å€¼
  81          ä»…é‡‡é›†æŒ‰ä¸‹åŠ¨ä½œï¼Œè¿”å›æŒ‰é”®å­—é¢å€¼ï¼Œå¹¶æ‰«æä¸‹ä¸€è¡ŒæŒ‰é”®
  82          å…¥å£å‚æ•°ï¼šæ— 
  83          å‡ºå£å‚æ•°ï¼šKeyValæŒ‰ä¸‹é”®çš„å­—é¢å€¼
  84          å¤‡æ³¨ï¼šä¸æ”¯æŒç»„åˆé”®
  85          **********************************************************/
  86          u8 GetKeyVal_Keyboard(void) //è¡Œåˆ—å¼æŒ‰é”®è¯»å–é”®å€¼å‡½æ•°
  87          {
  88   1        static uChar8 column_old[4] = {0xf0, 0xf0, 0xf0, 0xf0}; //å¤‡ä»½çš„ä¸Šæ¬¡è¯»å–åˆ—çš„ç”µå¹³å€¼ï¼Œå…±4è¡Œã
             -€‚
C51 COMPILER V9.54   KEY                                                                   03/07/2020 11:56:05 PAGE 3   

*** ERROR C141 IN LINE 88 OF Key.c: syntax error near 'column_old'
  89   1                                  //å‡½æ•°æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå¤‡ä»½ä¸€è¡Œå³æ›´æ–°ä¸€ä¸ªå…ƒç´ 
  90   1        static uChar8 row_i = 0;  //å½“å‰è¡Œç´¢å¼•
*** ERROR C231 IN LINE 90 OF Key.c: 'uChar8': redefinition
*** ERROR C141 IN LINE 90 OF Key.c: syntax error near 'row_i'
  91   1        
  92   1        uChar8 column_now, tmp, col, colrow, KeyVal;
*** ERROR C141 IN LINE 92 OF Key.c: syntax error near 'column_now'
*** ERROR C202 IN LINE 92 OF Key.c: 'column_now': undefined identifier
  93   1        
  94   1        col = 0x80;
*** ERROR C202 IN LINE 94 OF Key.c: 'col': undefined identifier
  95   1        column_now = P3 & 0xf0;   //è¯»å–å½“å‰è¡Œå¯¹åº”çš„åˆ—ç”µå¹³å€¼ï¼Œé«˜å››ä½æœ‰æ•ˆ
*** ERROR C202 IN LINE 95 OF Key.c: 'column_now': undefined identifier
  96   1        
  97   1        tmp = column_now ^ column_old[row_i]; //å¼‚æˆ–æ±‚å˜åŒ–ï¼Œæœ‰å˜åŒ–çš„ä½ä¸º1
*** ERROR C202 IN LINE 97 OF Key.c: 'tmp': undefined identifier
  98   1        
  99   1        if(tmp)     //æœ‰å˜åŒ–
*** ERROR C202 IN LINE 99 OF Key.c: 'tmp': undefined identifier
 100   1        {
 101   2          while(tmp <<= 1)
*** ERROR C202 IN LINE 101 OF Key.c: 'tmp': undefined identifier
 102   2            col >>= 1;    //ç¡®å®šåˆ—å·
*** ERROR C202 IN LINE 102 OF Key.c: 'col': undefined identifier
 103   2          if(col & column_now)
*** ERROR C202 IN LINE 103 OF Key.c: 'col': undefined identifier
 104   2            KeyVal = NOKEY; //æ¾å¼€
*** ERROR C202 IN LINE 104 OF Key.c: 'KeyVal': undefined identifier
 105   2          else
 106   2          {
 107   3            colrow = col | (1 << row_i);  //ç»„æˆè¡Œåˆ—å€¼
*** ERROR C202 IN LINE 107 OF Key.c: 'colrow': undefined identifier
 108   3            switch(colrow)
*** ERROR C202 IN LINE 108 OF Key.c: 'colrow': undefined identifier
 109   3            {
 110   4              case 0x88:  KeyVal = S4DOWN; break;
*** ERROR C202 IN LINE 110 OF Key.c: 'KeyVal': undefined identifier
 111   4              case 0x84:  KeyVal = S5DOWN; break;
*** ERROR C202 IN LINE 111 OF Key.c: 'KeyVal': undefined identifier
 112   4              case 0x82:  KeyVal = S6DOWN; break;
*** ERROR C202 IN LINE 112 OF Key.c: 'KeyVal': undefined identifier
 113   4              case 0x81:  KeyVal = S7DOWN; break;
*** ERROR C202 IN LINE 113 OF Key.c: 'KeyVal': undefined identifier
 114   4              case 0x48:  KeyVal = S8DOWN; break;
*** ERROR C202 IN LINE 114 OF Key.c: 'KeyVal': undefined identifier
 115   4              case 0x44:  KeyVal = S9DOWN; break;
*** ERROR C202 IN LINE 115 OF Key.c: 'KeyVal': undefined identifier
 116   4              case 0x42:  KeyVal = S10DOWN; break;
*** ERROR C202 IN LINE 116 OF Key.c: 'KeyVal': undefined identifier
 117   4              case 0x41:  KeyVal = S11DOWN; break;
*** ERROR C202 IN LINE 117 OF Key.c: 'KeyVal': undefined identifier
 118   4              case 0x28:  KeyVal = S12DOWN; break;
*** ERROR C202 IN LINE 118 OF Key.c: 'KeyVal': undefined identifier
 119   4              case 0x24:  KeyVal = S13DOWN; break;
*** ERROR C202 IN LINE 119 OF Key.c: 'KeyVal': undefined identifier
 120   4              case 0x22:  KeyVal = S14DOWN; break;
*** ERROR C202 IN LINE 120 OF Key.c: 'KeyVal': undefined identifier
 121   4              case 0x21:  KeyVal = S15DOWN; break;
*** ERROR C202 IN LINE 121 OF Key.c: 'KeyVal': undefined identifier
 122   4              case 0x18:  KeyVal = S16DOWN; break;
*** ERROR C202 IN LINE 122 OF Key.c: 'KeyVal': undefined identifier
C51 COMPILER V9.54   KEY                                                                   03/07/2020 11:56:05 PAGE 4   

 123   4              case 0x14:  KeyVal = S17DOWN; break;
*** ERROR C202 IN LINE 123 OF Key.c: 'KeyVal': undefined identifier
 124   4              case 0x12:  KeyVal = S18DOWN; break;
*** ERROR C202 IN LINE 124 OF Key.c: 'KeyVal': undefined identifier
 125   4              case 0x11:  KeyVal = S19DOWN; break;
*** ERROR C202 IN LINE 125 OF Key.c: 'KeyVal': undefined identifier
 126   4              default: KeyVal = NOKEY; break;
*** ERROR C202 IN LINE 126 OF Key.c: 'KeyVal': undefined identifier
 127   4            }
 128   3          }
 129   2          
 130   2        }
 131   1        else      //æ— å˜åŒ–
 132   1        {
 133   2          KeyVal = NOKEY;
*** ERROR C202 IN LINE 133 OF Key.c: 'KeyVal': undefined identifier
 134   2        }
 135   1        column_old[row_i++] = column_now; //å¤‡ä»½å½“å‰è¡Œæ‰«æå€¼
*** ERROR C202 IN LINE 135 OF Key.c: 'column_now': undefined identifier
 136   1        P3 = RowScanVal[row_i];       //æ‰«æä¸‹ä¸€è¡Œ
 137   1        return KeyVal;
*** ERROR C202 IN LINE 137 OF Key.c: 'KeyVal': undefined identifier
 138   1      }

C51 COMPILATION COMPLETE.  0 WARNING(S),  62 ERROR(S)
